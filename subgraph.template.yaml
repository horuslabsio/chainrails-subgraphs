specVersion: 0.0.4
description: Chainrails subgraph for monitoring intent funding
repository: https://github.com/horuslabsio/chainrails-subgraphs.git
schema:
    file: ./schema.graphql
dataSources:
    - kind: ethereum/contract
      name: IntentFactory
      # prettier-ignore
      network: {{network}}
      source:
          address: "{{intentFactory}}"
          abi: IntentFactory
          # prettier-ignore
          startBlock: {{startBlock}}
      context:
          # prettier-ignore
          chainId: {{chainId}}
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.6
          language: wasm/assemblyscript
          entities:
              - Intent
          abis:
              - name: IntentFactory
                file: ./abis/intent_factory.json
          eventHandlers:
              - event: IntentDeclared(indexed address,(uint8,uint8,(bytes32,uint256)[],bytes32,address,address,address,uint256,uint256,bool,bytes),indexed address)
                handler: handleIntentDeclared
          file: ./mappings/intent-factory.ts

    - kind: ethereum/contract
      name: USDC
      # prettier-ignore
      network: {{network}}
      source:
          address: "{{usdcAddress}}"
          abi: ERC20
          # prettier-ignore
          startBlock: {{startBlock}}
      context:
          # prettier-ignore
          chainId: {{chainId}}
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.6
          language: wasm/assemblyscript
          entities:
              - Intent
              - FundingTransaction
          abis:
              - name: ERC20
                file: ./abis/erc20.json
          eventHandlers:
              - event: Transfer(indexed address,indexed address,uint256)
                handler: handleUSDCTransfer
          file: ./mappings/erc20.ts
